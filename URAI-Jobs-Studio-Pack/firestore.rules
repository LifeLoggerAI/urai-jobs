rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    function isAdmin() { return request.auth != null && request.auth.token.admin == true; }
    function isSignedIn() { return request.auth != null; }

    match /jobs/{jobId} { allow read: if resource.data.status == 'open' || isAdmin(); allow create, update, delete: if isAdmin(); }
    match /applications/{appId} { allow create: if true; allow read, update, delete: if isAdmin() || (isSignedIn() && request.auth.uid == resource.data.uid); }
    match /candidates/{id} { allow read, write: if isAdmin(); }
    match /interviews/{id} { allow read, write: if isAdmin(); }
    match /offers/{id} { allow read, write: if isAdmin(); }
    match /weekly_scrolls/{id} { allow read, write: if isAdmin(); }
    match /forecasts/{id} { allow read, write: if isAdmin(); }
    match /marketing_campaigns/{id} { allow read, write: if isAdmin(); }
    match /marketing_recipients/{id} { allow read, write: if isAdmin(); }
    match /email_events/{id} { allow read, write: if isAdmin(); }
    match /campaign_stats/{campaignId}/daily/{day} { allow read, write: if isAdmin(); }

    match /jobs_queue/{id} { allow read, write: if isAdmin(); }
    match /executions/{id} { allow read, write: if isAdmin(); }
    match /schedules/{id} { allow read, write: if isAdmin(); }
    match /logs/{id} { allow read, write: if isAdmin(); }
  }
}
